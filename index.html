<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Flurimo ‚Äî –ú–∞–≥–∞–∑–∏–Ω</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
body {
  font-family: Arial, sans-serif;
  margin: 0;
  background: #faf9f7;
}
header {
  padding: 16px;
  text-align: center;
  font-size: 22px;
  font-weight: 600;
}
.card {
  background: #fff;
  margin: 12px;
  border-radius: 14px;
  overflow: hidden;
  box-shadow: 0 2px 6px rgba(0,0,0,.05);
}
.card img {
  width: 100%;
  height: 240px;
  object-fit: cover;
}
.card-content {
  padding: 14px;
}
.price {
  font-weight: bold;
  margin: 8px 0;
}
.status {
  font-size: 13px;
  opacity: .6;
  margin-bottom: 10px;
}
button {
  width: 100%;
  padding: 12px;
  background: #000;
  color: #fff;
  border: none;
  border-radius: 8px;
  font-size: 16px;
}
button:disabled {
  background: #ccc;
}
</style>
</head>

<body>
<header>üå∏ Flurimo</header>
<div id="catalog"></div>

<script>
const API_URL = "https://api.sheetbest.com/sheets/63008e42-f0f5-4d1a-a17d-bd61b27e9644";

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ —Å—Å—ã–ª–∫–∏ Google Drive –≤ –ø—Ä—è–º—É—é
function convertDriveLink(url) {
  if (!url) return "";
  const match = url.match(/\/d\/(.*?)\//);
  return match ? https://drive.google.com/uc?export=view&id=${match[1]} : url;
}

fetch(API_URL)
  .then(res => res.json())
  .then(data => {
    const catalog = document.getElementById('catalog');

    data.forEach(item => {
      const name = item["Name "]?.trim() || "–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è";
      const image = convertDriveLink(item["Image"]?.trim());
      const description = item["Description"]?.trim() || "";
      const quantity = item["Quantity"]?.trim() || "0";
      const price = item["Price"]?.trim() || "0";

      let statusText = "–ü–æ–¥ –∑–∞–∫–∞–∑";
      let disabled = false;

      if (quantity === "0") {
        statusText = "–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏";
        disabled = true;
      } else {
        statusText = "–í –Ω–∞–ª–∏—á–∏–∏";
      }

      const card = document.createElement('div');
      card.className = 'card';
      card.innerHTML = `
        <img src="${image}" alt="${name}" onerror="this.style.display='none'">
        <div class="card-content">
          <h3>${name}</h3>
          <p>${description}</p>
          <div class="status">${statusText}</div>
          <div class="price">${price} ‚ÇΩ</div>
          <button ${disabled ? 'disabled' : ''} onclick="order('${name}')">
            –û—Ñ–æ—Ä–º–∏—Ç—å
          </button>
        </div>
      `;
      catalog.appendChild(card);
    });
  })
  .catch(console.error);

function order(name) {
  Telegram.WebApp.sendData("–ó–∞–∫–∞–∑ Flurimo: " + name);
}
</script>
</body>
</html>
